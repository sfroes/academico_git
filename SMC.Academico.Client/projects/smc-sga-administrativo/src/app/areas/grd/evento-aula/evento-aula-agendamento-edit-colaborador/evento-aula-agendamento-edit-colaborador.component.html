<smc-modal s-size="xl" s-title="Alterar Colaborador(es) do Agendamento" (s-on-close)="fecharModal()">
  <div s-modal-body *ngIf="formEdit">
    <form [formGroup]="formEdit">
      <div class="smc-size-md-24 smc-size-lg-24">
        <fieldset class="smc-size-md-24 smc-size-lg-24 smc-sga-fieldset-agendamento">
          <legend>Dados da divisão de turma</legend>
          <div class="smc-size-lg-24 smc-size-md-24">
            <div class="smc-display">
              <label>Divisão de turma</label>
              <p>{{ divisao.descricaoDivisaoFormatada }}</p>
            </div>
          </div>
          <sga-bi-grd-001 [s-dados]="divisao"></sga-bi-grd-001>
        </fieldset>
      </div>
      <div class="smc-size-md-24 smc-size-lg-24">
        <fieldset class="smc-size-md-24 smc-size-lg-24 smc-sga-fieldset-agendamento">
          <legend>Quais ocorrências serão alteradas?</legend>
          <po-radio-group
            class="smc-sga-agendamento-radio-vertical smc-size-md-14 smc-size-lg-14"
            formControlName="tipoEdicao"
            p-columns="3"
            [p-options]="[
              { label: 'Somente esta ocorrência', value: '1' },
              { label: 'Todas as ocorrências', value: '2' },
              { label: 'Do período', value: '3' }
            ]"
            (p-change)="changeTipoEdicao($event)"
          >
          </po-radio-group>
          <po-datepicker
            class="smc-size-md-5 smc-size-lg-5 smc-sga-datepicker-horizontal"
            formControlName="dataInicio"
            p-label="Data início"
            [class.smc-datapicker-required]="dataObrigatoria"
            [hidden]="esconderDataPeriodo"
            [p-required]="dataObrigatoria"
          >
          </po-datepicker>
          <po-datepicker
            class="smc-size-md-5 smc-size-lg-5 smc-sga-datepicker-horizontal"
            formControlName="dataFim"
            p-error-pattern="A data fim deverá ser maior ou igual à data início."
            p-label="Data fim"
            [class.smc-datapicker-required]="dataObrigatoria"
            [hidden]="esconderDataPeriodo"
            [p-min-date]="formEdit.get('dataInicio').value"
            [p-required]="dataObrigatoria"
            [p-disabled]="divisao.tipoDistribuicaoAula !== 'Livre'"
          >
          </po-datepicker>
        </fieldset>
        <fieldset class="smc-size-md-24 smc-size-lg-24 smc-sga-fieldset-agendamento">
          <legend>Dados do agendamento</legend>
          <p class="smc-sga-agendamento-data">
            {{ eventoAula.diaSemanaFormatada }} de {{ eventoAula.horaInicio }} - {{ eventoAula.horaFim }}
          </p>
          <p class="smc-sga-agendamento-local" [class.smc-italico]="!eventoAula.codigoLocalSEF">
            {{ localFormatado() }}
          </p>
          <ul class="smc-sga-agendamento-professor">
            <li *ngFor="let professor of eventoAula.colaboradores" [class.smc-italico]="!professor.seqColaborador">
              {{ professor.descricaoFormatada }}
            </li>
          </ul>
          <fieldset class="smc-size-md-24 smc-size-lg-24 smc-sga-fieldset-secundario-agendamento">
            <legend>Professor (es)</legend>
            <div class="smc-sga-msg-instrucao">
              <p>Professor(es) fora do período de vínculo ativo não será(ão) alocado(s) ao(s) agendamento(s).</p>
            </div>
            <div class="smc-detalhe-botao-adicionar">
              <smc-button
                s-button-class="smc-btn-novo-ico"
                s-label="Novo professor"
                (s-click)="addProfessor()"
              ></smc-button>
            </div>
            <div formArrayName="colaboradores" class="smc-sga-mestre-tabular">
              <div *ngFor="let professor of getProfessores(); let indexProfessor = index">
                <div [formGroupName]="indexProfessor">
                  <div class="smc-size-md-24">
                    <smc-select
                      class="smc-size-md-21"
                      formControlName="seqColaborador"
                      s-label="Pesquisador/Professor"
                      [s-options]="dataSourceColaboradores"
                      (s-change)="dependencyProfessor(professor)"
                    ></smc-select>
                    <div class="smc-size-md-3 smc-size-lg-3 smc-sga-detalhe-botoes">
                      <smc-button
                        s-button-class="smc-btn-excluir-ico"
                        s-label="Excluir"
                        (s-click)="removeProfessor(indexProfessor)"
                      ></smc-button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>
        </fieldset>
      </div>
    </form>
  </div>
  <div s-modal-footer>
    <div *ngIf="mensagemInformativa" [class]="classeMensagemInformativa">
      <p>{{ mensagemInformativa }}</p>
    </div>
    <smc-button
      s-button-class="smc-btn-salvar-icotext-destaque"
      s-label="Salvar"
      s-type="submit"
      s-tooltip="Salvar"
      [s-loading]="validandoProfessor$ | async"
      [s-disabled]="formEdit?.invalid || formEdit?.pending || formEdit?.pristine"
      (s-click)="formatarMensagens()"
    ></smc-button>
    <smc-button
      s-button-class="smc-btn-fechar-icotext"
      s-label="Fechar"
      s-tooltip="Fechar"
      (s-click)="fecharModal()"
    ></smc-button>
  </div>
</smc-modal>
<!-- Assert de confirmação -->
<smc-modal s-title="Atenção!" #confirmar s-hide-close="true">
  <div s-modal-body>
    <p>{{ mensagemAssert }}</p>
    <p>Confirma a alteração?</p>
  </div>
  <div s-modal-footer>
    <smc-button s-label="Sim" s-tooltip="Sim" (s-click)="onSubmit()"></smc-button>
    <smc-button #btNao s-label="Não" s-tooltip="Não" (s-click)="confirmar.close()"></smc-button>
  </div>
</smc-modal>
