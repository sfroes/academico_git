@model RequisitoListarDynamicModel

@using (Smc.Div().Size(SMCSize.Grid24_24).CssClass("smc-listdetailed-item").Begin())
{
    using (Smc.Div().CssClass("smc-listdetailed-conteudo").Size(SMCSize.Grid23_24).Begin())
    {
        using (Smc.Div().CssClass("smc-listdetailed-conteudo-lista").Size(SMCSize.Grid24_24).Begin())
        {
            using (Smc.Div().CssClass("smc-sga-lista-legenda").Size(SMCSize.Grid1_24).Begin())
            {
                @Smc.LegendItem(m => m.Associado, false);
            }

            using (Smc.Div().CssClass("smc-listdetailed-conteudo-lista").Size(SMCSize.Grid11_24).Begin())
            {
                @Smc.DisplayFor(m => m.Itens);
            }

            using (Smc.Div().CssClass("smc-listdetailed-conteudo-lista smc-listdetailed-conteudo-separador-vertical").Size(SMCSize.Grid11_24).Begin())
            {
                @Smc.DisplayFor(m => m.MatrizesCurriculares);
            }
        }
    }

    SMCButtonFluentConfiguration buttonAssociarMatriz = Smc.Button(SMCButtonBehavior.Excluir)
        .Text(Smc.GetUIResource("Botao_Associar_Matriz_Curricular"))
        .Tooltip(Smc.GetUIResource("Botao_Associar_Matriz_Curricular"))
        .SecurityToken(UC_CUR_003_01_02.MANTER_REQUISITO)
        .Ajax(isPost: false)
        .Confirm(Smc.GetUIResource("Title_Associar_Matriz_Curricular"), Smc.GetUIResource("Associar_Matriz_Curricular_Confirmacao"))
        .Action("AssociarMatrizCurricular", "Requisito", new { seq = new SMCEncryptedLong(Model.Seq), seqMatrizCurricular = new SMCEncryptedLong(Model.SeqMatrizCurricular), seqCurriculoCursoOferta = new SMCEncryptedLong(Model.SeqCurriculoCursoOferta) });

    SMCButtonFluentConfiguration buttonDesassociarMatriz = Smc.Button(SMCButtonBehavior.Excluir)
                       .Text(Smc.GetUIResource("Botao_Desassociar_Matriz_Curricular"))
                       .Tooltip(Smc.GetUIResource("Botao_Desassociar_Matriz_Curricular"))
                       .SecurityToken(UC_CUR_003_01_02.MANTER_REQUISITO)
                       .Ajax(isPost: false)
                       .Confirm(Smc.GetUIResource("Title_Desassociar_Matriz_Curricular"), Smc.GetUIResource("Desassociar_Matriz_Curricular_Confirmacao"))
                       .Action("DesassociarMatrizCurricular", "Requisito", new { seq = new SMCEncryptedLong(Model.Seq), seqMatrizCurricular = new SMCEncryptedLong(Model.SeqMatrizCurricular), excluirRequisito = false, seqCurriculoCursoOferta = new SMCEncryptedLong(Model.SeqCurriculoCursoOferta) });

    SMCButtonFluentConfiguration buttonDesassociarExcluirMatriz = Smc.Button(SMCButtonBehavior.Excluir)
                       .Text(Smc.GetUIResource("Botao_Desassociar_Matriz_Curricular"))
                       .Tooltip(Smc.GetUIResource("Botao_Desassociar_Matriz_Curricular"))
                       .SecurityToken(UC_CUR_003_01_02.MANTER_REQUISITO)
                       .Ajax(isPost: false)
                       .Confirm(Smc.GetUIResource("Title_Desassociar_Matriz_Curricular"), Smc.GetUIResource("Desassociar_Excluir_Matriz_Curricular_Confirmacao"))
                       .Action("DesassociarMatrizCurricular", "Requisito", new { seq = new SMCEncryptedLong(Model.Seq), seqMatrizCurricular = new SMCEncryptedLong(Model.SeqMatrizCurricular), excluirRequisito = true, seqCurriculoCursoOferta = new SMCEncryptedLong(Model.SeqCurriculoCursoOferta) });

    if (Model.Associado == SMC.Academico.Common.Areas.CUR.Enums.TipoRequisitoAssociado.Associado && Model.UnicaMatrizAssociada)
    {
        @(Smc.Templates.DetailedListButtons().AllowEdit(true).AllowRemove(true).Size(SMCSize.Grid1_24).AddButton(buttonDesassociarExcluirMatriz));
    }
    else if (Model.Associado == SMC.Academico.Common.Areas.CUR.Enums.TipoRequisitoAssociado.Associado && !Model.UnicaMatrizAssociada)
    {
        @(Smc.Templates.DetailedListButtons().AllowEdit(false).AllowRemove(false).NumberOfButtonsToShow(0).Size(SMCSize.Grid1_24).AddButton(buttonDesassociarMatriz));
    }
    else
    {
        if (Model.Itens.Any(a => a.SeqGrupoCurricular > 0 && a.GrupoPertenceCurriculoMatrizOferta == false))
        {
            buttonAssociarMatriz.Enabled(false).ButtonInstructions(Smc.GetUIResource("Associar_Matriz_Curricular_Outro_Grupo"));
            @(Smc.Templates.DetailedListButtons().AllowEdit(false).AllowRemove(false).NumberOfButtonsToShow(0).Size(SMCSize.Grid1_24).AddButton(buttonAssociarMatriz));
        }
        else
        {
            @(Smc.Templates.DetailedListButtons().AllowEdit(false).AllowRemove(false).NumberOfButtonsToShow(0).Size(SMCSize.Grid1_24).AddButton(buttonAssociarMatriz));
        }
    }
}